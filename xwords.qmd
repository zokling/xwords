---
title: "xwords"
format: html
editor: source
---

# set up and data
```{r}
library(tidyverse)
library(glue)
```

```{r}
xwords <- read.csv("xwstats.csv")

xwords <- xwords |>
  filter(day_of_week != "Sunday") |> # never do sundays and i don't know what these are
  mutate(puzzle_date = as.Date(puzzle_date),
         completed_at = as_datetime(completed_at_et),
         time_taken_m = time_taken/60,
         day_of_week = factor(day_of_week, 
                             levels = c("Monday", 
                                        "Tuesday", "Wednesday", 
                                        "Thursday", "Friday", 
                                        "Saturday"), 
                             ordered = T)
  ) |>
  filter(as.Date(completed_at) > ymd("2023-01-01")) |> 
  select(-completed_at_et, -solved)
  
# remove outliers that represent NYT app problems
xwords$time_taken_m[xwords$time_taken_m > 120] <- NA

# min and max completion date parameters for chart subtitles
mindate <- as.Date(min(xwords$completed_at)) #earliest completion date
maxdate <- as.Date(max(xwords$completed_at)) #latest completion date

head(xwords)
```

### exploration

date range

```{r}
range(xwords$puzzle_date)
range(xwords$completed_at)
```

### time taken

```{r}
xwords |>
  ggplot(aes(x = time_taken_m)) +
  geom_histogram()
```

```{r}
  xwords |>
  ggplot(aes(x = time_taken_m)) +
  geom_histogram()
```

```{r}
xwords |>
  ggplot(aes(x = time_taken_m)) +
  geom_histogram(aes(fill = day_of_week)) +
  facet_wrap(~day_of_week) +
  theme_bw()
```

percentages with density plot

```{r}
xwords |>
  ggplot(aes(x = time_taken_m)) +
  geom_density(aes(fill = day_of_week)) +
  facet_wrap(~day_of_week) +
  labs(title = "") +
  theme_bw()
```

histo overall

```{r}
xwords |>
  filter(!(time_taken_m > 60) & day_of_week != "Su") |>  # remove outlier. remove sundays
  ggplot(aes(x = time_taken_m)) +
  geom_histogram(aes(fill = day_of_week)) +
  labs(title = "Distribution of NYT Xword Puzzle Solve Times", 
       subtitle = glue("Puzzles solved between {mindate} and {maxdate}"), 
       x = "Solve time in minutes",
       y = "Count", 
       fill = "Puzzle day of week") +
  theme_light()

ggsave("xword_solve_times_hist.jpeg", width = 9, height = 5, units = "in")

```

split by days with density plot

```{r}
xwords |>
  filter(!(time_taken_m > 600) & day_of_week != "Sunday") |>  # remove outlier. remove sundays
  ggplot(aes(x = time_taken_m)) +
  geom_density(aes(fill = day_of_week)) +
  labs(title = "Distribution of NYT Xword Puzzle Solve Times", 
       subtitle = glue("Puzzles solved between {mindate} and {maxdate}"), 
       x = "Solve time in minutes",
       y = "Density",
       fill = "Puzzle day of week") +
  theme_light()

ggsave("xword_solve_times_dist.jpeg", width = 9, height = 5, units = "in")
```

median

```{r}
xwords |>
  group_by(day_of_week) |>
  summarize(median_solvetime = median(time_taken_m, na.rm = T),
            mean_solvetime = mean(time_taken_m, na.rm = T))
```
looking surprisingly symmetrical

### puzzle solving speeds over time

have gone down...

```{r}
xwords |>
  ggplot(aes(x = as.Date(completed_at), y = time_taken_m)) +
  geom_point() +
  geom_smooth(se = F, method = "lm") +
  labs(subtitle = "date completed vs. time taken")
```

```{r}
xwords <- xwords |>
  mutate(completed_daysfromstart = as.Date(completed_at) - as.Date(min(completed_at)))

lm <- lm(time_taken ~ completed_daysfromstart, data = xwords)
summary(lm)
```
for every additional day i spend about half a second less on average

but maybe only because i'm doing more mondays

```{r}
xwords |>
  ggplot(aes(x = as.Date(completed_at), y = time_taken_m, color = day_of_week)) +
  geom_point() +
  geom_smooth(se = F, method = "lm") +
  labs(subtitle = "date completed vs. time taken")

lm2 <- lm(time_taken ~ completed_daysfromstart + factor(day_of_week, ordered = F), data = xwords)
summary(lm2)
```
controlling for day of puzzle there is no longer a trend :,(

```{r}
xwords |>
 # filter(as.Date(completed_at) >= ymd("2024-11-01")) |>
  ggplot(aes(x = as.Date(completed_at), y = time_taken_m, color = day_of_week)) +
  geom_line(linewidth = 1) 
```

by publishing date

```{r}
xwords |>
  ggplot(aes(x = puzzle_date, y = time_taken_m, color = day_of_week)) +
  geom_point() +
  labs(subtitle = "date of publication vs. time taken")
```

### how many puzzles was i doing over time?

```{r fig.width = 9 fig.height = 5}
annots <- tibble(
  label = c("Final semester\nof graduate school","Marriage and\nhoneymoon",
            "Seasonal\ndepression", "Distracted by\ncryptics"),
  xmin = c(ymd("2024-01-20"), ymd("2024-07-20"), ymd("2024-11-01"), ymd("2025-07-15")),
  xmax = c(ymd("2024-05-15"), ymd("2024-08-01"), ymd("2025-01-30"), ymd("2025-10-25"))
)

xwords |>
  ggplot(aes(x = as.Date(completed_at), fill = day_of_week)) +
  annotate("rect", xmin = annots$xmin[1:4],
           xmax = annots$xmax[1:4],
           ymin = 0, ymax = 24,
           alpha = 0.5, fill = "grey") +
  annotate("text", label = annots$label[1:4], 
           x = annots$xmin[1:4],
           y = 23,
           color = "grey30",
           size = 3, 
           hjust = 0) +
  geom_histogram(binwidth = 7) +
  scale_x_date(date_breaks = "3 months", date_labels = "%b %G") +
  labs(title = "NYT Xword Puzzles Solved Over Time", 
       subtitle = glue("Puzzles solved between {mindate} and {maxdate}"),
       x = "Date completed",
       y = "Puzzles completed in a seven-day period",
       fill = "Day of puzzle") +
  theme_light()

ggsave("xword_solve_over_time.jpeg", width = 9.5, height = 5, units = "in")
```

